# VideoRAG –ê–Ω–∞–ª–∏–∑: –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –û–ø–∏—Å–∞–Ω–∏–µ

---

## üåê –ö–æ–Ω—Ç–µ–∫—Å—Ç –ü—Ä–æ–µ–∫—Ç–∞

### üìå –û—Å–Ω–æ–≤–Ω–∞—è –ò–¥–µ—è
**VideoRAG** ‚Äî —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è –≤–∏–¥–µ–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ **RAG (Retrieval-Augmented Generation)**, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∏–π:
- **ImageBind** –¥–ª—è –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–≥–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞ –≤–∏–¥–µ–æ/–∞—É–¥–∏–æ/—Ç–µ–∫—Å—Ç–∞
- **LLM (–Ω–∞–ø—Ä–∏–º–µ—Ä, Llama)** –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤
- **–•—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ HNSWLib/Neo4j** –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É

### üß© –ö–ª—é—á–µ–≤—ã–µ –ü—Ä–æ–±–ª–µ–º—ã
| –ü—Ä–æ–±–ª–µ–º–∞ | –†–µ—à–µ–Ω–∏–µ –≤ VideoRAG |
|---------|-------------------|
| –ù–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–∏–¥–µ–æ-–∫–æ–Ω—Ç–µ–Ω—Ç | –í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å —Ç–∞–π–º–∫–æ–¥–∞–º–∏ |
| –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ | LLM —Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –≤–∏–¥–µ–æ—Å–µ–≥–º–µ–Ω—Ç—ã |
| –ù–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å ASR | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ |

### üéØ –¶–µ–ª–µ–≤–∞—è –ê—É–¥–∏—Ç–æ—Ä–∏—è
- –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥–µ–æ–∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–∏—Å—Ç–µ–º –æ–±—É—á–µ–Ω–∏—è
- –ö–æ–º–ø–∞–Ω–∏–∏ —Å –∞—Ä—Ö–∏–≤–∞–º–∏ –≤–∏–¥–µ–æ (–º–µ–¥–∏—Ü–∏–Ω–∞, —Å–ø–æ—Ä—Ç, —Å—É–¥—ã)
- UI/UX-–¥–∏–∑–∞–π–Ω–µ—Ä—ã –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –º–µ–¥–∏–∞

---

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

### üóÉÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ –ü–∞–ø–∫–∏ –∏ –§–∞–π–ª—ã
```
VideoRAG/
‚îú‚îÄ‚îÄ ImageBind/              # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–ª—è –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ imagebind_model.py  # –Ø–¥—Ä–æ CodeBind
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt    # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: torch, numpy...
‚îÇ
‚îú‚îÄ‚îÄ longervideos/           # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ download.sh         # –î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ
‚îÇ   ‚îî‚îÄ‚îÄ dataset.json        # –ê–Ω–∞–ª–∏—Ç–∏–∫–∞/–º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
‚îÇ
‚îú‚îÄ‚îÄ notebooks/              # –ü—Ä–∏–º–µ—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ videorag.ipynb      # –î–µ–º–æ Jupyter
‚îÇ
‚îú‚îÄ‚îÄ reproduce/              # –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –æ—Ü–µ–Ω–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ quantitative.../    # –î–ª—è —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
‚îÇ
‚îú‚îÄ‚îÄ videorag/               # –Ø–¥—Ä–æ VideoRAG
‚îÇ   ‚îú‚îÄ‚îÄ _llm.py             # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è LLM
‚îÇ   ‚îú‚îÄ‚îÄ _storage/           # HNSWLib/Neo4j/JSON –±—ç–∫—ç–Ω–¥
‚îÇ   ‚îú‚îÄ‚îÄ prompt.py           # –®–∞–±–ª–æ–Ω—ã RAG
‚îÇ   ‚îî‚îÄ‚îÄ videorag.py         # –ì–ª–∞–≤–Ω—ã–π API
‚îÇ
‚îú‚îÄ‚îÄ VideoRAG_analysis.md    # –≠—Ç–æ—Ç —Ñ–∞–π–ª!
‚îî‚îÄ‚îÄ VideoRAG.png            # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
```

---

## ‚öôÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –°—Ç–µ–∫

### üß± –Ø–∑—ã–∫–∏
- **Python** (99% –∫–æ–¥–∞)
- **Shell** (—É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∏ –∏ —Ç–µ—Å—Ç—ã)

### üß∞ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ –§—Ä–µ–π–º–≤–æ—Ä–∫–∏
<details>
<summary>–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏</summary>

```text
# requirements.txt (ImageBind)
torch>=1.10.0
torchvision>=0.4.0
tqdm
accelerate
sentencepiece
```

```text
# HNSWLib
hnswlib>=0.7.0
```

```text
# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ
opencv-python
pydub
ffmpeg
```

**–í–∞–∂–Ω–æ!** –î–ª—è —Ä–∞–±–æ—Ç—ã —Å GPU:
- CUDA 11.8 –∏–ª–∏ –Ω–æ–≤–µ–µ
- PyTorch compiled with CUDA support
</details>

### üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| **ImageBind** | –î–ª—è –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–π –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ |
| **Llama** | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ |
| **ASR** | Whisper –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –∏–∑ –∞—É–¥–∏–æ |

---

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ó–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```bash
git clone https://github.com/facebookresearch/VideoRAG.git
cd VideoRAG
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
# ImageBind
cd ImageBind
pip install -e .

# VideoRAG
cd ..
pip install -e .
```

### 3. –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```bash
cd longervideos
bash download.sh
python prepare_data.py
```

### 4. –ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
```bash
python -c "from videorag import VideoRAG; r = VideoRAG(); print(r.query('–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –≤–∏–¥–µ–æ?'))"
```

---

## üöÄ –ü—Ä–∏–º–µ—Ä—ã –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### üîç –°—Ü–µ–Ω–∞—Ä–∏–π 1: –í–æ–ø—Ä–æ—Å-–û—Ç–≤–µ—Ç
**–ó–∞–ø—Ä–æ—Å:**
```bash
"–ö–∞–∫–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –≥–æ–Ω–∫–µ –Ω–∞ 5-–π –º–∏–Ω—É—Ç–µ?"
```

**–ü—Ä–æ—Ü–µ—Å—Å:**
```
1. –†–µ—Ç—Ä–∏–≤–µ—Ä: –ø–æ–∏—Å–∫ –æ–∫—Ä–µ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è t=00:05:00
2. LLM: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ —Å –æ–ø–æ—Ä–æ–π –Ω–∞ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
3. –û—Ç–≤–µ—Ç: 
   "–ù–∞ 00:05:23 –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å Ferrari F1-2023 –∏ Mercedes W14"
```

### üìä –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–∏—Å–∫ –ø–æ –æ–±—ä–µ–∫—Ç–∞–º
```python
from videorag import VideoRAG
v = VideoRAG()
v.search("Tiger", EMOTIONAL_CONTEXT="aggressive")
# –ú–æ–¥—É–ª—è—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –ø–æ–¥—Å–∫–∞–∑–∫–æ–π
```

---

## üß± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ü—Ä–æ–µ–∫—Ç–∞

### üìò –û–±—â–∞—è –°—Ö–µ–º–∞
```
[–í–∏–¥–µ–æ] ‚Üí [–û–±—Ä–∞–±–æ—Ç–∫–∞ _videoutil] ‚Üí 
     ‚Üì
[ImageBind] ‚Üí [–í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è ‚Üí –•—Ä–∞–Ω–∏–ª–∏—â–µ (_storage)] ‚Üí
     ‚Üì
[LLM (_llm.py)] ‚Üí [–ì–µ–Ω–µ—Ä–∞—Ü–∏—è RAG-–æ—Ç–≤–µ—Ç–∞]
```

### üîÑ –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- `split.py` ‚Üí —Ä–∞–∑–±–∏–≤–∫–∞ –≤–∏–¥–µ–æ –Ω–∞ —Ç–∞–π–º–∫–æ–¥—ã
- `feature.py` ‚Üí –ø–æ–ª—É—á–µ–Ω–∏—è RGB/AUDIO/TEXT —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
- `vdb_hnswlib.py` ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ {–≤—Ä–µ–º–µ–Ω–Ω–æ–π_–∫–æ–¥, –æ–ø–∏—Å–∞–Ω–∏–µ}

---

## üìã –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¢–æ—á–∫–∏ –ê–¥–∞–ø—Ç–∞—Ü–∏–∏

### ‚öôÔ∏è –ß—Ç–æ –º–æ–∂–Ω–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å:
1. **–°–∏—Å—Ç–µ–º–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è**:
   ```python
   # videorag/_storage/
   from gdb_neo4j import Neo4jStorage
   db = Neo4jStorage(uri="neo4j://...", user="...", password="...")
   ```

2. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã LLM**:
   ```python
   # videorag/_llm.py
   LLM_CONFIG = {
       "temperature": 0.7,  # –î–ª—è –±–∞–ª–∞–Ω—Å–∞ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ vs –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏
       "max_tokens": 200
   }
   ```

3. **ASR/OCR Engine**:
   ```bash
   # –ó–∞–º–µ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ ASR-–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
   ASR_ENGINE="whisper_HF" python process.py
   ```

---

## üéØ UML-–î–∏–∞–≥—Ä–∞–º–º—ã (–¢–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ)

### 1. üß± –î–∏–∞–≥—Ä–∞–º–º–∞ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```plantuml
[–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ó–∞–ø—Ä–æ—Å] --> (VideRAG Core)
(VideRAG Core) --> (Video Processing Module)
(Video Processing Module) --> (ImageBind Module)
(ImageBind Module) --> (Storage Module)
(Storage Module) --> (LLM Module)
(LLM Module) --> [–ö–æ–Ω—Å–æ–ª—å–Ω—ã–π/Live –û—Ç–≤–µ—Ç]
```

### 2. üîÑ –î–∏–∞–≥—Ä–∞–º–º–∞ –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```plantuml
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å --> –†–µ—Ç—Ä–∏–µ–≤–µ—Ä: –í–æ–ø—Ä–æ—Å "–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ 02:30?"
–†–µ—Ç—Ä–∏–µ–≤–µ—Ä --> ImageBind: encode_query("—á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ 02:30?")
ImageBind --> –†–µ—Ç—Ä–∏–µ–≤–µ—Ä: —ç–º–±–µ–¥–¥–∏–Ω–≥_–≤–æ–ø—Ä–æ—Å–∞
–†–µ—Ç—Ä–∏–µ–≤–µ—Ä --> –•—Ä–∞–Ω–∏–ª–∏—â–µ: search(—ç–º–±–µ–¥–¥–∏–Ω–≥_–≤–æ–ø—Ä–æ—Å–∞)
–•—Ä–∞–Ω–∏–ª–∏—â–µ --> –†–µ—Ç—Ä–∏–µ–≤–µ—Ä: {—Å–µ–≥–º–µ–Ω—Ç—ã: 02:28, 02:33, 02:35}
–†–µ—Ç—Ä–∏–µ–≤–µ—Ä --> LLM: generate(–ø—Ä–∏–º–µ—Ä—ã –∏–∑ —Å–µ–≥–º–µ–Ω—Ç–æ–≤, "—á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç...")
LLM --> LLM: –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞
LLM --> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–ù–∞ —Ç–∞–π–º–∫–æ–¥–µ 02:33 –≤–∏–¥–Ω–æ, –∫–∞–∫... 
```

### 3. üóÉÔ∏è –î–∏–∞–≥—Ä–∞–º–º–∞ –ö–ª–∞—Å—Å–æ–≤ (–•—Ä–∞–Ω–∏–ª–∏—â–µ)
```plantuml
class Storage {
    +add_embedding(embedding: np.array, metadata: dict)
    +search(query_embedding: np.array, top_k: int): list
}

class HNSWLibStorage
class Neo4jStorage
class JSONLocalStorage

HNSWLibStorage --|> Storage
Neo4jStorage --|> Storage
JSONLocalStorage --|> Storage
```

---

## üß∞ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏: –ü–æ–¥—Ä–æ–±–Ω–æ–µ –û–ø–∏—Å–∞–Ω–∏–µ

### 1. **ImageBind**
#### üìå –ß—Ç–æ —ç—Ç–æ?
- **ImageBind** ‚Äî –º—É–ª—å—Ç–∏–º–æ–¥–µ–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ—Ç Meta, –∫–æ—Ç–æ—Ä–∞—è **—Å–≤—è–∑—ã–≤–∞–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã–µ, –∞—É–¥–∏–æ –∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ** –≤ –µ–¥–∏–Ω–æ–º —ç–º–±–µ–¥–¥–∏–Ω–≥-–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ.
- –û–±—É—á–µ–Ω–∞ –Ω–∞ –º–∏–ª–ª–∏–æ–Ω–∞—Ö –ø–∞—Ä "–≤–∏–¥–µ–æ-—Ç–µ–∫—Å—Ç", "–∞—É–¥–∏–æ-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" –∏ –¥—Ä—É–≥–∏—Ö –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

#### üß© –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç?
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç **—Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö** (–≤–∏–¥–µ–æ, –∞—É–¥–∏–æ, —Ç–µ–∫—Å—Ç) –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏—Ö –≤ **–≤–µ–∫—Ç–æ—Ä—ã (—ç–º–±–µ–¥–¥–∏–Ω–≥–∏)** –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏.
- –ü—Ä–∏–º–µ—Ä:
  ```python
  from imagebind import imagebind_model

  model = imagebind_model.load_model()
  video_embedding = model.encode_video(video_tensor)  # –í–µ–∫—Ç–æ—Ä –¥–ª—è –≤–∏–¥–µ–æ
  audio_embedding = model.encode_audio(audio_tensor)  # –í–µ–∫—Ç–æ—Ä –¥–ª—è –∞—É–¥–∏–æ
  text_embedding = model.encode_text(text_tensor)  # –í–µ–∫—Ç–æ—Ä –¥–ª—è —Ç–µ–∫—Å—Ç–∞
  ```

#### üéØ –ó–∞—á–µ–º –≤ VideoRAG?
- –ü–æ–∑–≤–æ–ª—è–µ—Ç **—Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö** (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å —Å –≤–∏–¥–µ–æ—Å–µ–≥–º–µ–Ω—Ç–æ–º).
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç **–≤—ã—Å–æ–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞** –ø–æ –≤–∏–¥–µ–æ –±–ª–∞–≥–æ–¥–∞—Ä—è –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–º—É –ø–æ–¥—Ö–æ–¥—É.

#### üß† –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- **–ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å**: –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 6 —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, —Ç–µ–∫—Å—Ç, –∞—É–¥–∏–æ, –≥–ª—É–±–∏–Ω–∞, —Ç–µ—Ä–º–∞–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, IMU).
- **–ï–¥–∏–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤**: –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ—Ü–∏—Ä—É—é—Ç—Å—è –≤ –æ–¥–Ω–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, —á—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ.

#### üìö –ö–∞–∫ –æ–±—É—á–∞–µ—Ç—Å—è ImageBind

##### üß¨ –°–∞–º–æ–æ–±—É—á–µ–Ω–∏–µ —Å –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∏–≤–Ω–æ–π –ø–æ—Ç–µ—Ä–µ–π
ImageBind –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥, –ø–æ—Ö–æ–∂–∏–π –Ω–∞ **CLIP** (–∫–æ–Ω—Ç—Ä–∞—Å—Ç–∏–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –∏ —Ç–µ–∫—Å—Ç–æ–º). –ù–æ —Å –∫–ª—é—á–µ–≤—ã–º –æ—Ç–ª–∏—á–∏–µ–º:  
**–æ–Ω —Ç—Ä–µ–Ω–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—è—Ö —Å—Ä–∞–∑—É**.

---

### üîÅ –°—Ö–µ–º–∞ –æ–±—É—á–µ–Ω–∏—è:
1. **–°–±–æ—Ä –ø–∞—Ä**:  
   ImageBind –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ —Ä–∞–∑–Ω—ã–µ –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç–∏:  
   - `"–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Üî –¢–µ–∫—Å—Ç"`
   - `"–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Üî –ê—É–¥–∏–æ"`
   - `"–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Üî –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"`

2. **–û–±—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å**:  
   –°—É–º–º–∞ **–∫–æ–Ω—Ç—Ä–∞—Å—Ç–∏–≤–Ω—ã—Ö –ª–æ—Å—Å–æ–≤** –¥–ª—è –∫–∞–∂–¥—ã—Ö –¥–≤—É—Ö –≤–∏–¥–æ–≤ –¥–∞–Ω–Ω—ã—Ö:  
   ```py
   loss = Œª1¬∑ContrastiveLoss(Image, Text) + 
          Œª2¬∑ContrastiveLoss(Image, Audio) +
          Œª3¬∑ContrastiveLoss(Image, Depth) +
          ...
   ```
   –ì–¥–µ Œª ‚Äî –≤–µ—Å–∞ –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç–µ–π.

3. **–û–±—É—á–µ–Ω–∏–µ —Å–µ—Ç–∏**:  
   –ú–æ–¥–µ–ª—å —Ç—Ä–µ–Ω–∏—Ä—É–µ—Ç—Å—è —Ç–∞–∫, —á—Ç–æ–±—ã:
   - –£–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —Å—Ö–æ–∂–µ—Å—Ç—å –º–µ–∂–¥—É –ø–∞—Ä–∞–º–∏ (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–∏)
   - –£–º–µ–Ω—å—à–∞—Ç—å —Å—Ö–æ–∂–µ—Å—Ç—å –º–µ–∂–¥—É –Ω–µ–ø–∞—Ä–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–∏)

---

### üåç –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

ImageBind –æ–±—É—á–∞–ª—Å—è –Ω–∞:
- **–û–±—Ä–∞–∑—Ü–∞—Ö –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞**: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è + –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Instagram)
- **–í–∏–¥–µ–æ** –∏–∑ –æ–±—É—á–∞—é—â–µ–≥–æ –Ω–∞–±–æ—Ä–∞
- **–¢–µ—Ä–º–∞–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** –∏ –¥—Ä—É–≥–∏–µ —Ä–µ–¥–∫–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏
- **–ê—É–¥–∏–æ–∑–∞–ø–∏—Å–∏** –∏–∑ –æ–±—É—á–∞—é—â–µ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞

–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏–ª–æ –æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –≤ **–º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ**, –≥–¥–µ –≤—Å–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –º–æ–≥—É—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω—ã.

---

### üß† –ü—Ä–∏–º–µ—Ä –æ–±—É—á–µ–Ω–∏—è:
```python
# –§—Ä–∞–≥–º–µ–Ω—Ç –ø—Å–µ–≤–¥–æ–∫–æ–¥–∞ –æ–±—É—á–µ–Ω–∏—è ImageBind
model = ImageBindModel()
criterion = ContrastiveLoss()

for batch in dataset:
    images, texts, audios = batch
    image_embs = model.encode_image(images)
    text_embs = model.encode_text(texts)
    audio_embs = model.encode_audio(audios)

    loss_it = criterion(image_embs, text_embs)
    loss_ia = criterion(image_embs, audio_embs)
    loss = loss_it + 0.8 * loss_ia

    loss.backward()
    optimizer.step()
```

---

### üß© –ò–Ω–Ω–æ–≤–∞—Ü–∏–∏ –≤ ImageBind:
1. **–ú—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å** ‚Äî –Ω–µ —Ç–æ–ª—å–∫–æ `–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ-—Ç–µ–∫—Å—Ç`, –Ω–æ –∏ `–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ-–∞—É–¥–∏–æ`, `–≥–ª—É–±–∏–Ω–∞-—Ç–µ–∫—Å—Ç` –∏ –¥—Ä.
2. **–ö–æ–Ω—Ç—Ä–∞—Å—Ç–∏–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –≤ —à–∏—Ä–æ–∫–æ–º —Å–ø–µ–∫—Ç—Ä–µ –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç–µ–π**
3. **–°–≤–æ–±–æ–¥–Ω–æ –æ–±—É—á–∞–µ–º–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ**, –≥–¥–µ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∞–Ω—ã –±–µ–∑ —è–≤–Ω—ã—Ö "–∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏—Ö" –ø–∞—Ä  
4. **–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –Ω–æ–≤—ã–º –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—è–º**, –µ—Å–ª–∏ –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω—ã —á–µ—Ä–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

---

### ‚öñÔ∏è –í–∞–∂–Ω—ã–µ –∫–æ–º–ø—Ä–æ–º–∏—Å—Å—ã:
- **–¢—Ä–µ–±—É–µ—Ç –≥–∏–≥–∞–Ω—Ç—Å–∫–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞** –∏ –º–æ—â–Ω–æ–π GPU-–≥—Ä—É–ø–ø—ã
- **–ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Ç–æ—á–Ω–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è** –º–µ–∂–¥—É –≤—Å–µ–º–∏ –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—è–º–∏
- –ú–æ–∂–µ—Ç "—Å–º–µ—â–∞—Ç—å—Å—è" –∫ —Ç–µ–º –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—è–º, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—É—á–∞–ª–∏—Å—å —Å–∏–ª—å–Ω–µ–µ –¥—Ä—É–≥–∏—Ö

---

### 2. **HNSWLib**
#### üìå –ß—Ç–æ —ç—Ç–æ?
- **HNSWLib** ‚Äî —ç—Ç–æ **–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –ø—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–≥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ —Å–æ—Å–µ–¥–∞ (ANN)**, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –±–ª–∏–∂–∞–π—à–∏–µ –≤–µ–∫—Ç–æ—Ä—ã –≤ –±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º **Hierarchical Navigable Small World (HNSW)** –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∞.

#### üß© –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç?
- –•—Ä–∞–Ω–∏—Ç –≤–µ–∫—Ç–æ—Ä—ã –≤ –≤–∏–¥–µ **–≥—Ä–∞—Ñ–∞**, –≥–¥–µ –∫–∞–∂–¥—ã–π —É–∑–µ–ª —Å–≤—è–∑–∞–Ω —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –¥—Ä—É–≥–∏–º–∏.
- –ü—Ä–∏ –ø–æ–∏—Å–∫–µ –∞–ª–≥–æ—Ä–∏—Ç–º "—Å–ø—É—Å–∫–∞–µ—Ç—Å—è" –ø–æ –≥—Ä–∞—Ñ—É, –Ω–∞—á–∏–Ω–∞—è —Å —Å–ª—É—á–∞–π–Ω–æ–π —Ç–æ—á–∫–∏, –∏ –Ω–∞—Ö–æ–¥–∏—Ç –±–ª–∏–∂–∞–π—à–∏–µ –≤–µ–∫—Ç–æ—Ä—ã.

#### üéØ –ó–∞—á–µ–º –≤ VideoRAG?
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **–ø–æ–∏—Å–∫–∞ –ø–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º**, —Å–æ–∑–¥–∞–Ω–Ω—ã–º ImageBind.
- –ü–æ–∑–≤–æ–ª—è–µ—Ç **–±—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –≤–∏–¥–µ–æ—Å–µ–≥–º–µ–Ω—Ç—ã** –ø–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É –∑–∞–ø—Ä–æ—Å—É.

#### üß† –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- **–í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å**: —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–∞–∑—ã –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã.
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö.
- **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**: –ª–µ–≥–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å Python.

---

## üîé –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏: HNSWLib vs FAISS

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞               | **HNSWLib**                               | **FAISS** (Facebook AI)                      |
|-----------------------------|-------------------------------------------|---------------------------------------------|
| **–ê–ª–≥–æ—Ä–∏—Ç–º**                | –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–π Navigable Small World –≥—Ä–∞—Ñ  | Quantization-based (IVF-PQ, HNSW –∏ –¥—Ä.)     |
| **–°–∫–æ—Ä–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞ (1k vec)**| –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è                             | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è (—á–∞—Å—Ç–æ –≤—ã—à–µ –ø—Ä–∏ GPU-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏) |
| **–ü–∞–º—è—Ç—å**                  | –í—ã—Å–æ–∫–∞—è (–∏–∑-–∑–∞ –≥—Ä–∞—Ñ–∞)                     | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è (–ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–æ–≤) |
| **–¢–æ—á–Ω–æ—Å—Ç—å**                | –í—ã—Å–æ–∫–∞—è                                   | –í—ã—Å–æ–∫–∞—è (–ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ)          |
| **GPU –ø–æ–¥–¥–µ—Ä–∂–∫–∞**           | Limited (–±–∞–∑–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –Ω–∞ GPU)        | –û—Ç–ª–∏—á–Ω–∞—è GPU-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (CUDA/NVIDIA)  ‚úÖ  |
| **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**  | –ü—Ä–æ—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, –ø–æ–Ω—è—Ç–Ω—ã–π API         | –°–ª–æ–∂–Ω–µ–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ                         |
| **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–∞**     | –î–æ 20K (–≤ —Ç–µ–æ—Ä–∏–∏)                         | –î–æ –º–∏–ª–ª–∏–æ–Ω–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ (–≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Meta)  |
| **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**        | –ú–∏–ª–ª–∏–æ–Ω—ã –∑–∞–ø–∏—Å–µ–π                          | –î–æ –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤ –≤–µ–∫—Ç–æ—Ä–æ–≤ (FAISS Pro)          |

---

## üìå –ó–∞—á–µ–º –≤ –¥–∞–Ω–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è HNSWLib?

| –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ HNSWLib         | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ VideoRAG                        |
|------------------------------|----------------------------------------------|
| –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º | –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å—Ü–µ–Ω–∞—Ä–∏–∏ real-time              |
| –ù–∏–∑–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–¥—É     | –ü—Ä–æ—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Python –∫–æ–¥              |
| –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö | –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –≤–∏–¥–µ–æ–∑–∞–ø–∏—Å–µ–π |
| –ù–µ –Ω—É–∂–µ–Ω –º–æ—â–Ω—ã–π GPU          | –†–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –Ω–∞ CPU                        |

---

## üö´ –ö–æ–≥–¥–∞ —Å—Ç–æ–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å FAISS:
- **–ï—Å–ª–∏ –≤–∏–¥–µ–æ >12 —á–∞—Å–æ–≤** –∏–ª–∏ **—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ö—Ä–∞–Ω–∏—Ç—å –º–∏–ª–ª–∏–∞—Ä–¥—ã —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤**
- **–î–æ—Å—Ç—É–ø–µ–Ω GPU** –∏ –≤–∞–∂–Ω–∞ –≤—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–¢—Ä–µ–±—É–µ—Ç—Å—è –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å** –ø–æ–∏—Å–∫–∞

---

## üîß –ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –ø–æ–¥—Ö–æ–¥—è—â—É—é?
| –ï—Å–ª–∏ –≤–∞–∂–Ω–æ: | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|------------|--------------|
| –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏ —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞ | HNSWLib ‚úÖ |
| –†–∞–±–æ—Ç–∞ –Ω–∞ CPU | HNSWLib ‚úÖ |
| GPU-—É—Å–∫–æ—Ä–µ–Ω–∏–µ | FAISS ‚úÖ |
| –•—Ä–∞–Ω–∏—Ç—å –º–∏–ª–ª–∏–∞—Ä–¥—ã —Ç–æ—á–µ–∫ | FAISS ‚úÖ |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å PyTorch | FAISS ‚úÖ |

---

### 3. **Neo4j**
#### üìå –ß—Ç–æ —ç—Ç–æ?
- **Neo4j** ‚Äî —ç—Ç–æ **–≥—Ä–∞—Ñ–æ–≤–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**, –∫–æ—Ç–æ—Ä–∞—è —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ –≤–∏–¥–µ **—É–∑–ª–æ–≤ –∏ —Å–≤—è–∑–µ–π**.
- –ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –≤–∑–∞–∏–º–æ—Å–≤—è–∑–µ–π –º–µ–∂–¥—É –¥–∞–Ω–Ω—ã–º–∏.

#### üß© –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç?
- –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –≤–∏–¥–µ **–≥—Ä–∞—Ñ–∞**, –≥–¥–µ:
  - **–£–∑–ª—ã** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å—É—â–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–∏–¥–µ–æ—Å–µ–≥–º–µ–Ω—Ç—ã).
  - **–°–≤—è–∑–∏** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "—Å–ª–µ–¥—É–µ—Ç –∑–∞", "—Å–≤—è–∑–∞–Ω —Å").
- –ó–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —è–∑—ã–∫–∞ **Cypher**, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—Ö–æ–∂ –Ω–∞ SQL, –Ω–æ –¥–ª—è –≥—Ä–∞—Ñ–æ–≤.

#### üéØ –ó–∞—á–µ–º –≤ VideoRAG?
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –ø–æ–∏—Å–∫–∞ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –≤–∏–¥–µ–æ—Å–µ–≥–º–µ–Ω—Ç–∞–º–∏**.
- –ü–æ–∑–≤–æ–ª—è–µ—Ç **–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç** –≤–∏–¥–µ–æ, —É—á–∏—Ç—ã–≤–∞—è –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Å–≤—è–∑–∏.

#### üß† –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- **–ì–∏–±–∫–æ—Å—Ç—å**: –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Å–≤—è–∑–µ–π.
- **–ú–æ—â–Ω—ã–π —è–∑—ã–∫ –∑–∞–ø—Ä–æ—Å–æ–≤**: Cypher –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –≥—Ä–∞—Ñ—É.
- **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è**: Neo4j –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–æ–≤.

---

### 4. **LLaMA**
#### üìå –ß—Ç–æ —ç—Ç–æ?
- **LLaMA** ‚Äî —ç—Ç–æ **—Å–µ–º–µ–π—Å—Ç–≤–æ –±–æ–ª—å—à–∏—Ö —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π (LLM)** –æ—Ç Meta, –∫–æ—Ç–æ—Ä–æ–µ –≤–∫–ª—é—á–∞–µ—Ç –º–æ–¥–µ–ª–∏ —Ä–∞–∑–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ (–æ—Ç 7B –¥–æ 65B –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤).
- –û–±—É—á–µ–Ω–æ –Ω–∞ –æ–≥—Ä–æ–º–Ω—ã—Ö –æ–±—ä–µ–º–∞—Ö —Ç–µ–∫—Å—Ç–∞ –∏ —Å–ø–æ—Å–æ–±–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç, –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥—Ä—É–≥–∏–µ –∑–∞–¥–∞—á–∏.

#### üß© –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç?
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç **—Ç–µ–∫—Å—Ç–æ–≤—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç** –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç **–æ—Ç–≤–µ—Ç** –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É **—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∞**, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥–µ–ª–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Å–ª–æ–≤–∞–º–∏.

#### üéØ –ó–∞—á–µ–º –≤ VideoRAG?
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤** –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ—Å–µ–≥–º–µ–Ω—Ç–æ–≤.
- –ü–æ–∑–≤–æ–ª—è–µ—Ç **—Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã**, –∫–æ—Ç–æ—Ä—ã–µ —É—á–∏—Ç—ã–≤–∞—é—Ç —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –≤–∏–¥–µ–æ.

#### üß† –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- **–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å**: LLaMA –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Ç–ª–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ –º–Ω–æ–≥–∏—Ö –∑–∞–¥–∞—á–∞—Ö NLP.
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –¥–æ—Å—Ç—É–ø–Ω—ã –º–æ–¥–µ–ª–∏ —Ä–∞–∑–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á.
- **–û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å**: Meta –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë –≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö –∏ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö.

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### üìã –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|--------------|----------|
| `MAX_MEMORY_LIMIT` | `.env` | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GPU |
| `EMBEDDING_DIM` | `videorag/feature.py` | –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –≤–µ–∫—Ç–æ—Ä–æ–≤ |
| `TOP_K_RESULTS` | `videorag/_op.py` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ |

**–í–∞–∂–Ω–æ:** –í —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –Ω–µ—Ç —è–≤–Ω–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã.

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
cd reproduce
python batch_quant_eval_calculate.py
```

### 2. –¢–∏–ø—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
| –¢–∏–ø | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|-----|------------|
| –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã | –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (split.py) |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ | –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–≤—è–∑–Ω–æ—Å—Ç—å pipeline |
| –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–µ | –î–ª—è –≤—ã–ø—É—Å–∫–æ–≤ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π |

**–°—Ç–∞—Ç—É—Å –ø–æ–∫—Ä—ã—Ç–∏—è:** —Å—Ä–µ–¥–Ω–µ–µ (–æ–∫–æ–ª–æ 50%)

---

## üåê –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### üì¶ –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
```bash
cd VideoRAG
docker build -t videorag .
docker run -p 5000:5000 videorag
```

### ‚ö†Ô∏è –°–∏—Å—Ç–µ–º–Ω—ã–µ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ú–∏–Ω–∏–º—É–º | –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è |
|----------|---------|--------------|
| GPU | 16GB VRAM | 32GB+ |
| CPU | 8 —è–¥–µ—Ä | 12+ —è–¥–µ—Ä |
| RAM | 32GB | 64GB+ |

---

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è –∏ –í–∫–ª–∞–¥

### üìú –õ–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω–∏–µ
- **ImageBind**: MIT License (Meta)
- **VideoRAG**: MIT License (Meta)

### ü§ù –ö–∞–∫ –≤–∑—è—Ç—å —É—á–∞—Å—Ç–∏–µ
1. Fork –ø—Ä–æ–µ–∫—Ç–∞
2. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ `/reproduce` –∏–ª–∏ `/videorag`
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã:
   ```bash
   cd reproduce
   python batch_winrate_eval_calculate.py
   ```
4. Pull Request —Å –ø–æ–º–µ—Ç–∫–æ–π `[enhancement]` –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: https://github.com/facebookresearch/VideoRAG

---

## ‚ö†Ô∏è –ü–æ–¥–≤–æ–¥–Ω—ã–µ –ö–∞–º–Ω–∏

### üß® –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏
1. **CUDA MEMORY OUT OF BOUNDS**
   ```bash
   # –†–µ—à–µ–Ω–∏–µ:
   export MAX_TOKENS=512
   python -X dev --env CUDA_MEMORY_LIMIT=8GiB
   ```
2. **–ü–∞–¥–µ–Ω–∏–µ ASR-–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π**
   ```bash
   # –î–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —è–∑—ã–∫–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã:
   sudo apt install libopenblas-dev
   pip install torchaudio
   ```

3. **–ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤–µ—Ä—Å–∏–π**
   ```bash
   # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–∏:
   pip install torch==2.0.0+cu118 torchvision==0.15.0+cu118 --extra-index-url https://download.pytorch.org/whl/cu118
   ```

---

üí° *P.S. –≠—Ç–∏ PlantUML-–¥–∏–∞–≥—Ä–∞–º–º—ã –º–æ–∂–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä PlantUML/Visual Studio Code —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º –¥–ª—è PlantUML, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ.*

**–ï—Å–ª–∏ —Ç—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—à—å —Å—Ä–µ–¥—É –ø–æ–¥ Mac M-series —á–µ—Ä–µ–∑ Rosetta - —Å–∫–∞–∂–∏, —è –ø–æ–¥–≥–æ—Ç–æ–≤–ª—é —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ–¥ Apple Silicon.**